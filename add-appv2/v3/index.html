<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>User Page</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>
<body>

  <div class="container">
    <h2>User Page</h2>
    <hr>

    <div class="pull-right">
      <button class="btn btn-primary filter-button" data-filter="all">All</button>
      <button class="btn btn-primary filter-button" data-filter="games">Games</button>
      <button class="btn btn-primary filter-button" data-filter="social media">Social Media</button>
      <button class="btn btn-primary filter-button" data-filter="marketing">Marketing</button>
    </div>

    <br><br>

    <h3>Choose a Section</h3>
    <select id="sectionDropdown" class="form-control">
      <!-- Dynamically populated sections -->
    </select>

    <br><br>

    <!-- Search Box -->
    <div class="form-group">
      <input id="search-box" type="text" class="form-control" placeholder="Search Apps..." />
    </div>

    <br>
<center><a href="https://dymond.systems/cardbetav1/boardv4/" class="btn btn-success" style="margin-top: 10px; margin-bottom: 10px;">Back to dashbord</a></center>
    <div class="gallery">
      <!-- Cards will be populated here -->
    </div>

  </div>

  <script>
    // Sample predefined cards
    const predefinedCards = [
      { id: '3', title: 'Spotify', description: 'Stream music and podcasts.', tag: 'music,streaming', filter: 'social media', image: 'https://static.vecteezy.com/system/resources/previews/042/148/631/non_2x/spotify-logo-spotify-social-media-icon-free-png.png' },
      { id: '2', title: 'Roblox', description: 'Stupid games that look like legos', tag: 'games,fun', filter: 'games', image: 'https://upload.wikimedia.org/wikipedia/commons/7/7e/Roblox_Logo_2022.jpg' },
       { id: '1',
      title: 'PromptGPT',
      description: 'Manage chatGPT prompts: by stackboard',
      image: 'https://1000logos.net/wp-content/uploads/2023/02/ChatGPT-Logo.png',
      category: 'Entertainment',
      tag: 'chat, ai, gpt, bot', // data-tag
      filter: 'entertainment', // data-filter
      borderClass: 'border-primary',
      textClass: 'text-primary',
      modalId: '1',
    },
      // Add more predefined cards...
    ];

    // Function to populate the section dropdown from localStorage
    function populateSectionDropdown() {
      const sections = JSON.parse(localStorage.getItem('sections')) || [];
      const dropdown = document.getElementById('sectionDropdown');
      dropdown.innerHTML = ''; // Clear existing options

      sections.forEach(section => {
        const option = document.createElement('option');
        option.value = section.id;
        option.textContent = section.title;
        dropdown.appendChild(option);
      });

      if (sections.length === 0) {
        alert('No sections available. Please create sections first.');
      }
    }

    // Function to populate the cards in the gallery based on search and filters
    function populateCards() {
      const galleryContainer = document.querySelector('.gallery');
      galleryContainer.innerHTML = ''; // Clear existing cards

      predefinedCards.forEach(card => {
        const cardHtml = `
          <div class="col-md-3 text-center card-item" data-filter="${card.filter}" data-tag="${card.tag}">
            <div class="thumbnail">
              <h3>${card.title}</h3>
              <img class="img-fluid h-100" alt="${card.title}" src="${card.image}">
              <div class="caption">
                <h4>${card.description}</h4>
                <button type="button" data-target="${card.id}" class="btn btn-primary addCardBtn">
                  Add to Section
                </button>
              </div>
            </div>
          </div>
        `;
        galleryContainer.innerHTML += cardHtml;
      });

      // Add event listeners for the buttons to add cards to sections
      document.querySelectorAll('.addCardBtn').forEach(button => {
        button.addEventListener('click', () => {
          const cardId = button.getAttribute('data-target');
          const sectionId = document.getElementById('sectionDropdown').value;
          
          if (!sectionId) {
            alert('Please select a section first.');
            return;
          }

          const card = predefinedCards.find(c => c.id === cardId);
          if (card) {
            card.sectionId = sectionId;
            const addedCards = JSON.parse(localStorage.getItem('addedCards')) || [];
            addedCards.push(card);
            localStorage.setItem('addedCards', JSON.stringify(addedCards));

            alert(`Card "${card.title}" added to section!`);
          }
        });
      });
    }

    // Function to get the section ID from the URL parameter and set it in the dropdown
    function setSectionFromURL() {
      const urlParams = new URLSearchParams(window.location.search);
      const sectionId = urlParams.get('sectionId');
      const sectionDropdown = document.getElementById('sectionDropdown');
      
      if (sectionId) {
        sectionDropdown.value = sectionId; // Set the dropdown to the section from URL
      }
    }

    // Search filter functionality
    $(document).on('input', '#search-box', function() {
      var query = $(this).val().toLowerCase();

      $('.gallery .col-md-3').each(function() {
        var title = $(this).find('h3').text().toLowerCase();

        if (title.includes(query)) {
          $(this).fadeIn();
        } else {
          $(this).fadeOut();
        }
      });
    });

    // Filter functionality
    $(document).on('click', '.filter-button', function() {
      const filter = $(this).data('filter');

      $('.gallery .col-md-3').each(function() {
        const cardFilter = $(this).data('filter');
        if (filter === 'all' || cardFilter === filter) {
          $(this).fadeIn();
        } else {
          $(this).fadeOut();
        }
      });
    });

    // Initialize the page
    document.addEventListener('DOMContentLoaded', () => {
      populateSectionDropdown();
      setSectionFromURL();
      populateCards();
    });
  </script>

</body>
</html>
